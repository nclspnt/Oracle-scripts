@display_configuration.sql


col SQL_PLAN_HASH_VALUE format 999999999999999999
col AVG_ACTIVE_SESSION format 99999.99
col DELTA_READ_IO_MB format 9999999999.99
col DELTA_WRITE_IO_MB format 9999999999.99
col TM_DELTA_TIME_SECOND format 999999999,99
col DELTA_READ_IO_BYTES format 999999999,99
col DELTA_WRITE_IO_BYTES format 999999999,99
col DELTA_INTERCONNECT_IO_BYTES format 999999999,99
col DELTA_INTERCONNECT_IO_MB format 999999999,99



select 
trunc(SAMPLE_TIME,'MI') SAMPLE_TIME_MINUTE,
round(count(distinct SESSION_ID||','||SESSION_SERIAL#)/60,2) AVG_ACTIVE_SESSION,
SQL_PLAN_HASH_VALUE,
round(sum(TM_DELTA_TIME)/count(SESSION_ID||','||SESSION_SERIAL#)/1000000/60,2) TM_DELTA_TIME_SECOND_PER_EXEC,
sum(DELTA_READ_IO_BYTES)/1024/1024 DELTA_READ_IO_MB,
sum(DELTA_WRITE_IO_BYTES)/1024/1024 DELTA_WRITE_IO_MB,
sum(DELTA_INTERCONNECT_IO_BYTES)/1024/1024 DELTA_INTERCONNECT_IO_MB
from gv$active_session_history
where sql_id = '&sql_id.'
and SAMPLE_TIME > sysdate - 1/24
group by trunc(SAMPLE_TIME,'MI'), SQL_PLAN_HASH_VALUE
order by 1
;
